<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rabbit PipeFit Pro</title>

<style>
:root{--orange:#ff4e00;--bg:#000;--card:#111;--text:#fff}
body{margin:0;background:var(--bg);color:var(--text);font-family:sans-serif}
.header{text-align:center;padding:8px;border-bottom:2px solid var(--orange);font-weight:bold}
.tabs{display:flex;height:42px;background:#111}
.tab-btn{flex:1;border:none;background:none;color:#666;font-size:.6rem;font-weight:bold}
.tab-btn.active{color:var(--orange);border-bottom:2px solid var(--orange)}
.content{padding:10px;height:calc(100vh - 84px);overflow:auto}
.card{background:var(--card);border:1px solid #333;border-radius:12px;padding:12px;margin-bottom:10px}
.label{font-size:.6rem;color:#888;display:block;margin-bottom:4px}
input,select{width:100%;padding:8px;background:#222;border:1px solid #444;color:white;border-radius:8px;margin-bottom:8px}
.res-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.res-box{background:#000;border:1px solid var(--orange);border-radius:8px;padding:8px;text-align:center}
.res-val{font-size:1.3rem;color:var(--orange);font-weight:bold}
.res-txt{font-size:.55rem;color:#888}
table{width:100%;border-collapse:collapse;font-size:.6rem}
th{position:sticky;top:0;background:#000;color:var(--orange);padding:4px}
td{padding:4px;border-bottom:1px solid #222}
</style>
</head>

<body>

<div class="header">PIPEFIT PRO – RABBIT R1</div>

<div class="tabs">
  <button id="t-dec" class="tab-btn active" onclick="showTab('dec')">Décroché</button>
  <button id="t-coude" class="tab-btn" onclick="showTab('coude')">Coude</button>
  <button id="t-aba" class="tab-btn" onclick="showTab('aba')">Abaques</button>
</div>

<div class="content">

<!-- DECROCHÉ SIMPLIFIÉ -->
<div id="sec-dec">
  <div class="card">
    <span class="label">Diamètre (DN)</span>
    <select id="dec-dn" onchange="calcDec()"></select>

    <span class="label">Hauteur du décroché H (mm)</span>
    <input type="number" id="dec-h" oninput="calcDec()">

    <div class="res-grid">
      <div class="res-box">
        <span id="dec-aa" class="res-val">--</span>
        <span class="res-txt">Axe-Axe</span>
      </div>
      <div class="res-box">
        <span id="dec-cut" class="res-val">--</span>
        <span class="res-txt">Coupe tube</span>
      </div>
    </div>
  </div>
</div>

<!-- COUDE -->
<div id="sec-coude" style="display:none">
  <div class="card">
    <span class="label">Diamètre (DN)</span>
    <select id="c-dn" onchange="calcCoude()"></select>

    <span class="label">Angle</span>
    <select id="c-a" onchange="calcCoude()">
      <option value="90">90°</option>
      <option value="45">45°</option>
    </select>

    <div class="res-grid">
      <div class="res-box">
        <span id="c-res" class="res-val">--</span>
        <span class="res-txt">Encombrement (mm)</span>
      </div>
      <div class="res-box">
        <span class="res-val">R = 1.5D</span>
        <span class="res-txt">Standard atelier</span>
      </div>
    </div>
  </div>
</div>

<!-- ABAQUES -->
<div id="sec-aba" style="display:none">
  <select id="sel-norme" onchange="renderAbaque()">
    <option value="iso">ISO / EN Acier</option>
    <option value="asme">ASME B36 (Sch)</option>
  </select>

  <div class="card" style="padding:0">
    <table>
      <thead><tr id="thr"></tr></thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</div>

</div>

<script>
/* ---------- DONNÉES DIAMÈTRES COMPLETS ---------- */
const diametresISO = [
 {dn:"DN10",od:17.2,e:20},
 {dn:"DN15",od:21.3,e:25},
 {dn:"DN20",od:26.9,e:30},
 {dn:"DN25",od:33.7,e:35},
 {dn:"DN32",od:42.4,e:40},
 {dn:"DN40",od:48.3,e:45},
 {dn:"DN50",od:60.3,e:55},
 {dn:"DN65",od:76.1,e:65},
 {dn:"DN80",od:88.9,e:75},
 {dn:"DN100",od:114.3,e:90},
 {dn:"DN125",od:139.7,e:110},
 {dn:"DN150",od:168.3,e:130},
 {dn:"DN200",od:219.1,e:170},
 {dn:"DN250",od:273.0,e:210},
 {dn:"DN300",od:323.9,e:250},
 {dn:"DN350",od:355.6,e:280},
 {dn:"DN400",od:406.4,e:320},
 {dn:"DN450",od:457.0,e:360},
 {dn:"DN500",od:508.0,e:400},
 {dn:"DN600",od:610.0,e:480}
];

/* ---------- ONGLET ---------- */
function showTab(t){
 ['dec','coude','aba'].forEach(s=>{
  document.getElementById('sec-'+s).style.display='none';
  document.getElementById('t-'+s).classList.remove('active');
 });
 document.getElementById('sec-'+t).style.display='block';
 document.getElementById('t-'+t).classList.add('active');
 if(t==='aba') renderAbaque();
}

/* ---------- INIT SELECT ---------- */
function initSelects(){
 const decSel=document.getElementById('dec-dn');
 const cSel=document.getElementById('c-dn');
 diametresISO.forEach(d=>{
  decSel.innerHTML+=`<option value="${d.dn}">${d.dn} (Ø${d.od})</option>`;
  cSel.innerHTML+=`<option value="${d.dn}">${d.dn} (Ø${d.od})</option>`;
 });
}

/* ---------- DECROCHÉ SIMPLIFIÉ ---------- */
function calcDec(){
 const dn=document.getElementById('dec-dn').value;
 const h=Number(document.getElementById('dec-h').value);
 if(!h) return;
 const d=diametresISO.find(x=>x.dn===dn);
 const aa=Math.round(h*1.414);
 const cut=Math.max(aa-(2*d.e),0);
 document.getElementById('dec-aa').innerText=aa;
 document.getElementById('dec-cut').innerText=cut;
}

/* ---------- COUDE ---------- */
function calcCoude(){
 const dn=document.getElementById('c-dn').value;
 const a=document.getElementById('c-a').value;
 const d=diametresISO.find(x=>x.dn===dn);
 const r=1.5*d.od;
 document.getElementById('c-res').innerText=
  a==="90"?Math.round(r):Math.round(r/2);
}

/* ---------- ABAQUES ---------- */
const bigData={
 iso:{
  h:["DN","Ø ext mm","Pouce"],
  d:diametresISO.map(d=>[d.dn,d.od,(d.od/25.4).toFixed(2)])
 },
 asme:{
  h:["NPS","Ø ext mm","Pouce"],
  d:[
   ["1/2","21.34","0.5"],["1","33.4","1"],["2","60.3","2"],
   ["4","114.3","4"],["6","168.3","6"],["8","219.1","8"],
   ["10","273.0","10"],["12","323.9","12"],["16","406.4","16"],
   ["20","508.0","20"],["24","610.0","24"]
  ]
 }
};

function renderAbaque(){
 const n=document.getElementById('sel-norme').value;
 document.getElementById('thr').innerHTML=
  bigData[n].h.map(h=>`<th>${h}</th>`).join('');
 document.getElementById('tbody').innerHTML=
  bigData[n].d.map(r=>`<tr>${r.map(c=>`<td>${c}</td>`).join('')}</tr>`).join('');
}

window.onload=initSelects;
</script>

</body>
</html>

